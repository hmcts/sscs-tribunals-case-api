java:
  image: ${IMAGE_NAME}
  ingressHost: ${SERVICE_FQDN}
  readinessDelay: 45
  environment:
    PDF_API_URL: "http://rpe-pdf-service-aat.service.core-compute-aat.internal"
    CORE_CASE_DATA_API_URL: "http://ccd-data-store-api-aat.service.core-compute-aat.internal"
    DOCUMENT_MANAGEMENT_URL: "http://dm-store-aat.service.core-compute-aat.internal"
    IDAM_S2S_AUTH: "http://rpe-service-auth-provider-aat.service.core-compute-aat.internal"
    IDAM_API_URL: https://idam-api.aat.platform.hmcts.net
    IDAM_API_JWK_URL: https://idam-api.aat.platform.hmcts.net/jwks
    CREATE_CCD_ENDPOINT: true
    SECURE_DOC_STORE_FEATURE: true
    CASE_DOCUMENT_AM_URL: http://ccd-case-document-am-api-aat.service.core-compute-aat.internal
    WORK_ALLOCATION_FEATURE: true
    CASE_ACCESS_MANAGEMENT_FEATURE: true
    SCHEDULE_LISTING_FEATURE: true
    CCD_CALLBACK_ORCHESTRATOR_API_URL: http://${SERVICE_NAME}-sscs-ccd-callback-orchestrator
    CORE_CASE_DATA_JURISDICTION_ID: SSCS
    CORE_CASE_DATA_CASE_TYPE_ID: Benefit-${CHANGE_ID}
    TOPIC_NAME: "${SERVICE_NAME}-servicebus-main-topic"
    SUBSCRIPTION_NAME: "${SERVICE_NAME}-servicebus-main-topic"
    AMQP_HOST: "sscs-sb-preview.servicebus.windows.net"
    AMQP_USERNAME: "RootManageSharedAccessKey"
    HEARINGS_EVENT_QUEUE_NAME: ${SERVICE_NAME}-servicebus-tribunals-to-hearing-api
    secrets:
      HEARINGS_EVENT_SERVICE_BUS_CONNECTION_STRING:
        secretRef: sscs-sb-preview
        key: connectionString
      AMQP_PASSWORD:
        secretRef: sscs-sb-preview
        key: primaryKey

xui-webapp:
  enabled: ${HEARINGS_ENABLED}
  nodejs:
    memoryLimits: "4Gi"
    cpuLimits: 2000m
    memoryRequests: "1Gi"
    cpuRequests: "1"
    imagePullPolicy: Always
    releaseNameOverride: ${SERVICE_NAME}-xui-webapp
    image: hmctspublic.azurecr.io/xui/webapp:latest
    ingressHost: xui-${SERVICE_FQDN}
    environment:
      HEALTH_TERMS_AND_CONDITIONS_API: http://${SERVICE_NAME}-xui-terms-and-conditions/health
      SERVICES_CCD_CASE_ASSIGNMENT_API: http://${SERVICE_NAME}-aac
      SERVICES_TERMS_AND_CONDITIONS: http://${SERVICE_NAME}-xui-terms-and-conditions
      SERVICES_IDAM_API_URL: https://idam-api.aat.platform.hmcts.net
      SERVICES_S2S: http://rpe-service-auth-provider-aat.service.core-compute-aat.internal
      SERVICES_HEARINGS_COMPONENT_API: http://jurisdiction-hearings-api-aat.service.core-compute-aat.internal
      SERVICES_HEARINGS_COMPONENT_API_SSCS: http://${SERVICE_NAME}-sscs-hearings-api
      SERVICES_PRD_LOCATION_API: http://rd-location-ref-api-aat.service.core-compute-aat.internal
      SERVICES_PRD_JUDICIAL_API: http://rd-judicial-api-aat.service.core-compute-aat.internal
      SERVICES_PRD_COMMONDATA_API: http://rd-commondata-api-aat.service.core-compute-aat.internal
      SERVICES_DOCUMENTS_API_V2: http://${SERVICE_NAME}-ccd-case-document-am-api
      GLOBAL_SEARCH_SERVICES: IA,CIVIL,PRIVATELAW,PUBLICLAW,SSCS
      JURISDICTIONS: SSCS
      LAUNCH_DARKLY_CLIENT_ID: 5de6610b23ce5408280f2268
      FEATURE_REDIS_ENABLED: false
      FEATURE_APP_INSIGHTS_ENABLED: false
      FEATURE_SECURE_COOKIE_ENABLED: false
      FEATURE_PROXY_ENABLED: false
      FEATURE_TERMS_AND_CONDITIONS_ENABLED: false
      FEATURE_HELMET_ENABLED: false
      FEATURE_OIDC_ENABLED: false
      ALLOW_CONFIG_MUTATIONS: true
      FEATURE_JRD_E_LINKS_V2_ENABLED: true
      NOW: false
      REDISCLOUD_URL: http://dummyrediscloudurl
      UV_THREADPOOL_SIZE: 128
      PROTOCOL: http
    keyVaults:
      rpx:
        resourceGroup: rpx
        secrets:
          - mc-s2s-client-secret
          - mc-idam-client-secret
          - system-user-name
          - system-user-password

sscs-ccd-callback-orchestrator:
  enabled: ${HEARINGS_ENABLED}
  java:
    ingressHost: cbo-${SERVICE_FQDN}
    image: hmctspublic.azurecr.io/sscs/ccd-callback-orchestrator:latest
    releaseNameOverride: ${SERVICE_NAME}-sscs-ccd-callback-orchestrator
    readinessDelay: 90
    environment:
      SUBSCRIPTION_NAME: "${SERVICE_NAME}-servicebus-main-topic"
      TOPIC_NAME: "${SERVICE_NAME}-servicebus-main-topic"
      AMQP_HOST: "sscs-sb-preview.servicebus.windows.net"
      AMQP_USERNAME: "RootManageSharedAccessKey"
    secrets:
      AMQP_PASSWORD:
        secretRef: sscs-sb-preview
        key: primaryKey

sscs-hearings-api:
  enabled: ${HEARINGS_ENABLED}
  java:
    image: "hmctspublic.azurecr.io/sscs/hearings-api:latest" #Change to pr if required
    releaseNameOverride: ${SERVICE_NAME}-sscs-hearings-api
    ingressHost: hearings-${SERVICE_FQDN}
    environment:
      ROOT_LOGGING_LEVEL: INFO
      SSCS_LOG_LEVEL: INFO #Switch to debug to see requests being sent.
      SERVICE_BUS_LOG_LEVEL: ERROR
      LOG_OUTPUT: single
      CREATE_CCD_ENDPOINT: false
      IDAM_S2S_URL: "http://rpe-service-auth-provider-aat.service.core-compute-aat.internal"
      CASEWORKER_REF_API_URL: "http://rd-caseworker-ref-api-aat.service.core-compute-aat.internal"
      IDAM_API_URL: "https://idam-api.aat.platform.hmcts.net"
      CORE_CASE_DATA_API_URL: "http://ccd-data-store-api-aat.service.core-compute-aat.internal"
      COMMON_REF_API_URL: "http://rd-commondata-api-aat.service.core-compute-aat.internal"
      JUDICIAL_REF_API_URL: "http://rd-judicial-api-aat.service.core-compute-aat.internal"
      EXUI_API_URL: "https://${SERVICE_NAME}-xui"
      HMC_API_URL: "http://hmc-cft-hearing-service-aat.service.core-compute-aat.internal"
      #Messaging
      HMC_HEARINGS_LISTENING_ENABLED: true
      HMC_HEARINGS_TOPIC_NAME: "hmc-to-cft-aat"
      HMC_HEARINGS_TOPIC_SUBSCRIPTION_NAME: "hmc-to-sscs-subscription-pr-3575"
      TRIBUNALS_HEARINGS_LISTENING_ENABLED: true
      TRIBUNALS_EVENT_QUEUE_NAME: ${SERVICE_NAME}-servicebus-tribunals-to-hearing-api
      TRIBUNALS_EVENT_QUEUE_POLICY_NAME: RootManageSharedAccessKey
      TRIBUNALS_EVENT_QUEUE_NAMESPACE: sscs-sb-preview
      HMC_HEARINGS_TOPIC_NAMESPACE: hmc-servicebus-aat
      HMC_DEPLOYMENT_ID: deployment-${SERVICE_NAME}
      HMC_DEPLOYMENT_FILTER_ENABLED: true
      CORE_CASE_DATA_CASE_TYPE_ID: Benefit-${CHANGE_ID}
    secrets:
      TRIBUNALS_EVENT_QUEUE_ACCESS_KEY:
        secretRef: sscs-sb-preview
        key: primaryKey
    keyVaults:
      sscs:
        secrets:
          - name: hmc-servicebus-shared-access-key-tf
            alias: HMC_HEARINGS_TOPIC_ACCESS_KEY
          - name: sscs-hearing-manager-username
            alias: IDAM_SSCS_SYSTEMUPDATE_USER
          - name: sscs-hearing-manager-pass
            alias: IDAM_SSCS_SYSTEMUPDATE_PASSWORD
          - name: app-insights-connection-string
            alias: app-insights-connection-string
          - name: sscs-s2s-secret
            alias: IDAM_S2S_AUTH_TOTP_SECRET
          - name: idam-oauth-user
            alias: IDAM_OAUTH2_CLIENT_ID
          - name: idam-sscs-oauth2-client-secret
            alias: IDAM_OAUTH2_CLIENT_SECRET

servicebus:
  enabled: ${HEARINGS_ENABLED}
  resourceGroup: sscs-aso-preview-rg
  sbNamespace: sscs-servicebus-preview
  setup:
    topics:
      - name: main-topic
        subscriptionNeeded: yes
    queues:
      - name: sscs-orchestrator-queue-preview
      - name: tribunals-to-hearing-api

ccd-def-cleanup:
  enabled: true
  change_id: ${CHANGE_ID}
  case_type_ids:
    - Benefit